function resetforgotpassword(){$("#newpasswordmessage").text(""),$("#newpasswordemail").val("")}function validateImg(e){var s=e.name.split(".").pop().toLowerCase();return-1===$.inArray(s,["gif","png","jpg","jpeg"])?1:($file_size=e.size/1048576,$file_size>5?2:!0)}function setCookie(e,s,a){var o=new Date;o.setTime(o.getTime()+24*a*60*60*1e3);var r="expires="+o.toUTCString();document.cookie=e+"="+s+"; "+r+"; path=/"}function getCookie(e){for(var s=e+"=",a=document.cookie.split(";"),o=0;o<a.length;o++){for(var r=a[o];" "==r.charAt(0);)r=r.substring(1);if(-1!=r.indexOf(s))return r.substring(s.length,r.length)}return""}function checkCookie(e){var s=getCookie("user_id");(""===s||null===s)&&setCookie("user_id",e,10)}function autologin(){var e=getCookie("user_id");""!==e&&($.session.set("user",e),window.location.assign("home/"))}function clear(){$("#regfullname").val(""),$("#regemail").val(""),$("#regusername").val(""),$("#regpassword").val(""),$("#regconfirmpassword").val(""),$("#missingname").text(""),$("#uniqueemailcheck").text(""),$("#uniqueusernamecheck").text(""),$("#passwordstrength").text(""),$("#passwordconfirm").text(""),$("#regerrormsg").text(""),checkfullname=!1,checkusername=!1,checkemail=!1,checkpassword=!1,checkconfirmpassword=!1}function check(){""===$("#usernameemail").val()?($("#missingusernameemail").text("Enter username or email"),checkusernameemail=!1):($("#missingusernameemail").text(""),checkusernameemail=!0),""===$("#loginpassword").val()?($("#missingpassword").text("Enter password"),checkloginpassword=!1):($("#missingpassword").text(""),checkloginpassword=!0)}function validateEmail(e){var s=/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;return s.test(e)}function validateFullname(e){var s=/^[a-zA-Z]+ [a-zA-Z]+$/;return s.test(e)}function validateUsername(e){var s=/^[a-zA-Z0-9]*$/;return s.test(e)}function checksystemusername(e){return"home"===e&&"discover"===e&&"notifications"===e?!1:!0}$(document).ready(function(){var e=!1,s=!1;$("#usernameemail").blur(function(){""===$("#usernameemail").val()?($("#missingusernameemail").text("Enter username or email"),e=!1):($("#missingusernameemail").text(""),e=!0)}),$("#loginpassword").blur(function(){""===$("#loginpassword").val()?($("#missingpassword").text("Enter password"),s=!1):($("#missingpassword").text(""),s=!0)}),$("#usernameemail").click(function(){$("#usernameemail").css({"box-shadow":"none"})}),$("#loginpassword").click(function(){$("#loginpassword").css({"box-shadow":"none"})}),$("#signin").click(function(){if(check(),e&&s){if(validateEmail($("#usernameemail").val()))var a="email";else var a="username";console.log(a),$.ajax({type:"POST",url:BASE_URL+"user_details/login",data:{usernameemail:$("#usernameemail").val(),loginpassword:$("#loginpassword").val(),type:a}}).done(function(a){console.log(a),console.log(a.status),"SUCCESS"===a.status?(e=!1,s=!1,checkCookie(a.data[0].user_details.id),window.location.assign(BASE_URL+"home"),$("#loginerror").text(""),console.log(a.message)):$("#loginerror").text(a.message)})}else $("#loginerror").text("please fill above details"),$("#usernameemail").css({"box-shadow":"0px 0px 7px red"}),$("#loginpassword").css({"box-shadow":"0px 0px 7px red"})});var a=!1,o=!1,r=!1,n=!1,i=!1;$("#regfullname").blur(function(){validateFullname($("#regfullname").val())?""===$("#regfullname").val()?($("#missingname").text("Enter name"),a=!1):($("#missingname").text(""),a=!0):($("#missingname").css({color:"red"}),$("#missingname").text("Enter valid name"),a=!1)}),$("#regemail").blur(function(){validateEmail($("#regemail").val())?""!==$("#regemail").val()?($("#uniqueemailcheck").css({color:"green"}),$("#uniqueemailcheck").text(""),$.ajax({type:"POST",url:BASE_URL+"user_details/checkemail",data:{email:$("#regemail").val()}}).done(function(e){console.log(e),"FAILURE"==e.status?($("#uniqueemailcheck").css({color:"green"}),$("#uniqueemailcheck").text(e.message),r=!0):($("#uniqueemailcheck").css({color:"red"}),$("#uniqueemailcheck").text(e.message),r=!1)})):($("#uniqueemailcheck").css({color:"red"}),$("#uniqueemailcheck").text("Enter email"),r=!1):($("#uniqueemailcheck").css({color:"red"}),$("#uniqueemailcheck").text("Enter valid email id"),r=!1)}),$("#regusername").blur(function(){validateUsername($("#regusername").val())?checksystemusername($("#regusername").val())?""!==$("#regusername").val()?$.ajax({type:"POST",url:BASE_URL+"user_details/checkusername",data:{username:$("#regusername").val()}}).done(function(e){console.log(e),"FAILURE"==e.status?($("#uniqueusernamecheck").css({color:"green"}),$("#uniqueusernamecheck").text(e.message),o=!0):($("#uniqueusernamecheck").css({color:"red"}),$("#uniqueusernamecheck").text(e.message),o=!1)}):($("#uniqueusernamecheck").css({color:"red"}),$("#uniqueusernamecheck").text("Enter username"),o=!1):($("#uniqueusernamecheck").css({color:"red"}),$("#uniqueusernamecheck").text("Username does not exist.please enter another username"),o=!1):($("#uniqueusernamecheck").css({color:"red"}),$("#uniqueusernamecheck").text("Enter valid username.username can contain a-z,A-Z,0-9"),o=!1)}),$("#regpassword").keyup(function(){$("#regpassword").val().length>7?($("#passwordstrength").css({color:"green"}),$("#passwordstrength").text("strong password"),n=!0):($("#passwordstrength").css({color:"red"}),$("#passwordstrength").text("cannot accept weak password"),n=!1)}),$("#regpassword").blur(function(){""===$("#regpassword").val()&&($("#passwordstrength").css({color:"red"}),$("#passwordstrength").text("Enter Password"),n=!1)}),$("#regconfirmpassword").blur(function(){""===$("#regconfirmpassword").val()&&($("#passwordconfirm").css({color:"red"}),$("#passwordconfirm").text("Enter confirm Password"),i=!1)}),$("#regconfirmpassword").keyup(function(){$("#regconfirmpassword").val()===$("#regpassword").val()?""!==$("#regconfirmpassword").val()&&""!==$("#regpassword").val()?($("#passwordconfirm").css({color:"green"}),$("#passwordconfirm").text("Password match"),i=!0):($("#passwordconfirm").css({color:"red"}),$("#passwordconfirm").text(""),i=!1):($("#passwordconfirm").css({color:"red"}),$("#passwordconfirm").text("Password mismatch"),i=!1)}),$("#register").click(function(e){e.preventDefault(),o&&n&&r&&a&&i?$.ajax({type:"POST",url:BASE_URL+"user_details/register",data:{fullname:$("#regfullname").val(),email:$("#regemail").val(),username:$("#regusername").val(),password:$("#regpassword").val()}}).done(function(e){console.log(e),"SUCCESS"===e.status?($("#RegisterModal").hide(),$("#ProfileDetailsModal").modal({show:!0})):$("#regerrormsg").text(e.message)}):$("#regerrormsg").text("Please fill above fields correctly")}),$("#reset").click(function(){clear()}),$("#openBtn").click(function(){$("#missingpassword").text(""),$("#missingusernameemail").text(""),$("#loginerror").text(""),$("#RegisterModal").modal({show:!0})}),$("#closemark").click(function(){clear()}),$("#closebutton").click(function(){clear()}),$("#sendnewpassword").click(function(){""===$("#newpasswordemail").val()?($("#newpasswordemail").css({"box-shadow":"0px 0px 7px red"}),$("#newpasswordmessage").css({color:"red"}),$("#newpasswordmessage").text("Enter email address")):validateEmail($("#newpasswordemail").val())?$.ajax({type:"POST",url:BASE_URL+"user_details/forgotpasswordemail",data:{email:$("#newpasswordemail").val()}}).done(function(e){console.log(e),"SUCCESS"===e.status?($("#newpasswordmessage").css({color:"#428bca"}),$("#newpasswordmessage").text(e.message)):($("#newpasswordmessage").css({color:"red"}),$("#newpasswordmessage").text(e.message))}):($("#newpasswordmessage").css({color:"red"}),$("#newpasswordmessage").text("Enter valid email address"))}),$("#newpasswordemail").click(function(){$("#newpasswordemail").css({"box-shadow":"none"})}),$("#forgotpassword").click(function(){$("#missingpassword").text(""),$("#missingusernameemail").text(""),$("#loginerror").text(""),$("#ForgotPasswordModal").modal({show:!0})}),$("#closebuttonForgotpassword").click(function(){resetforgotpassword()}),$("#closemarkforgotpassword").click(function(){resetforgotpassword()});var t=!1,l=!1,c=null;$("#Bio").keyup(function(){var e=$(this).val().length;$(this).parent().siblings("#textcount").text(160-e),160!==e&&(t=!0)}),$("#uploadimage").change(function(){console.log("binding"),c=$(this)[0].files[0];var e=validateImg(c);e===!0?l=!0:alert(1===e?"Invalid File Extension! Please choose valid picture file":"File is too big..Choose file having size less than 5MB")}),$("#save").click(function(){var e=new FormData;if(e.append("data[Upload][myimage]",$("#uploadimage")[0].files[0]),console.log(new FormData(this)),l===!0&&$.ajax({type:"post",url:BASE_URL+"uploads/index",data:e,contentType:!1,cache:!1,processData:!1}).done(function(e){"SUCCESS"===e.status?(console.log(e.message),console.log("done")):console.log(e.message)}),t===!0){var s=$("#Bio").val();console.log(s),$.ajax({type:"post",url:BASE_URL+"user_details/editBio",data:{bio:s}}).done(function(e){console.log("SUCCESS"===e.status?e.message:e.message)})}$("#ProfileDetailsClose").trigger("click"),window.location.assign("home/")}),$("#ProfileDetailsClose").click(function(){window.location.assign("home/")})});